# 📦 包數功能使用說明

## 🎯 功能概述

包數功能允許同一筆工單有多個不良品分類記錄，系統會自動為每個工單的記錄分配包數（第1包、第2包、第3包...），方便追蹤和管理同一工單的不同批次不良品。

## 🔧 功能特點

### ✨ 自動累加機制
- **智能編號**：系統自動為同一工單的記錄分配連續包數
- **預覽顯示**：輸入工單號碼後顯示預計的下一個包數
- **提交累加**：只有在成功提交不良品登錄時才實際累加包數
- **防重複**：確保包數編號的唯一性和連續性

### 📊 即時資訊顯示
- **當前包數**：顯示即將登錄的包數
- **歷史記錄**：顯示該工單已有的包數記錄數量
- **智能提示**：清楚的說明文字指導用戶操作

## 📋 使用步驟

### 1. 不良品登錄
1. **選擇不良品類型**：在上方選擇區域選擇不良品類型
2. **輸入工單號碼**：輸入工單號碼後系統自動顯示包數資訊
3. **查看包數資訊**：
   - 系統顯示：`📦 預計包數: 第X包`
   - 提示說明：`💡 此工單目前已有X包記錄，提交後將成為第X包`
4. **填寫其他資訊**：完成產品名稱、數量等必填欄位
5. **提交登錄**：點擊登錄按鈕完成

### 2. 包數顯示範例
```
工單號碼: WO-2024-001
📦 預計包數: 第3包
💡 此工單目前已有2包記錄，提交後將成為第3包
```

## 🔍 包數追蹤

### 在各個頁面的顯示
- **儀表板**：緊急處理項目顯示包數資訊
- **處理追蹤**：所有記錄都顯示對應的包數
- **統計分析**：可以按包數進行統計分析

### 顯示格式
- **標題顯示**：`工單: WO-2024-001 - 產品名稱 (第3包)`
- **詳細資訊**：`包數: 第3包`
- **數量顯示**：`數量: 100 pcs`

## 📈 實際應用場景

### 場景1：同一工單多批次檢驗
```
工單: WO-2024-001 (iPhone外殼)
第1包: 檢具NG - 50pcs
第2包: 表面缺陷 - 30pcs  
第3包: 外觀不良 - 20pcs
```

### 場景2：分批處理大量不良品
```
工單: WO-2024-002 (筆記本電腦殼)
第1包: 組裝不良 - 100pcs
第2包: 組裝不良 - 80pcs
第3包: 功能異常 - 25pcs
```

## 💡 使用建議

### ✅ 最佳實踐
1. **按批次登錄**：將同一工單的不良品按發現批次分別登錄
2. **詳細描述**：在問題描述中註明具體的批次資訊
3. **及時處理**：每包記錄都要及時處理，避免積壓

### ⚠️ 注意事項
1. **工單號碼一致性**：確保同一工單的包數記錄使用相同的工單號碼
2. **包數自動性**：包數由系統自動分配，無需手動輸入
3. **歷史記錄**：已登錄的包數記錄無法修改包數編號
4. **⭐ 重要提醒**：包數只有在實際提交不良品登錄時才會累加，僅輸入工單號碼不會累加包數

## 🔧 技術細節

### 資料庫結構
```sql
ALTER TABLE defects ADD COLUMN package_number INTEGER DEFAULT 1;
```

### 自動累加邏輯
```python
def get_next_package_number(work_order):
    # 查詢該工單的最大包數
    SELECT MAX(package_number) FROM defects WHERE work_order = ?
    # 返回下一個包數 (最大值 + 1)
    return (result + 1) if result else 1
```

## 🚀 系統狀態

✅ **包數功能已啟用**  
✅ **自動累加正常運作**  
✅ **所有頁面已更新顯示**  
✅ **資料庫結構已升級**  

---

## 📞 技術支援

如有任何問題或建議，請聯繫系統管理員。

*文檔版本：v1.0*  
*更新時間：2024年6月18日* 